# PHP / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º
```mermaid
graph TD;
	–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è{–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è} --> checkRegister
	checkRegister -- —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞ --> login
	checkRegister -- —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É—Å–ø–µ—à–Ω–∞ --> register
```

## –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
* –ò–∑ —Ñ–æ—Ä–º—ã `registerForm.php` -> `checkRegister.php`
  * –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–≤ —Ä–∞–∑–¥–µ–ª–µ *"–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã"*)
* –ò–∑ `checkRegister.php` -> `login.php`:
  <details>
  <summary>
  login.php
  </summary>
  
  ```
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∏–∑ registerForm.php —Å –∏–Ω—Ñ–æ–π –æ —Ç–æ–º, —á—Ç–æ –º—ã –∑–∞—Ä–µ–≥–∞–ª–∏—Å—å, –∏–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º, –µ—Å–ª–∏ –º—ã —Ç—É—Ç –≤–ø–µ—Ä–≤—ã–µ
  <p class="login-form__valid">
    <?php
      if (isset($_SESSION['iAmRegister']) && $_SE['iAmRegister'] === 'on') {
        echo "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–º–æ–∂–Ω–æ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è:";
        $_SESSION['iAmRegister'] = '';
      } else {
        echo "";
      }
    ?>
  </p>
  ```
  </details>
  
* –ò–∑ `checkRegister.php` -> `register.php`:
  <details>
  <summary>
  register.php
  </summary>
  
  ```
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è —Å –∏–Ω—Ñ–æ–π –æ —Ç–æ–º, —á—Ç–æ —Ç–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å, –∏–ª–∏ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –Ω–∏—á–µ–≥–æ
  <p class="alreadyExist incorrect-text" id="errorUser">
    <?php
      if (isset($_SESSION['alreadyExist']) && $['alreadyExist'] ===   true)   {
        echo "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å–ü—Ä–∏–¥—É–º–∞–π     —á—Ç–æ-–Ω–∏–±—É–¥—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–µ–µ";
        $_SESSION['alreadyExist'] = false;
      } else {
        echo "";
      }
    ?>
  </p>
  ```
  </details>

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
<details>
<summary>
–ó–∞–ø—É—Å–∫ —Å–µ—Å—Å–∏–∏
</summary>

```
session_start();
```

</details>

<details>
<summary>
–†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –∏–∑ `register.php`
</summary>

```
$login = filter_var(trim($_POST['registerLogin']));
$_SESSION['alreadyExist'] = false; // –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ register.php / –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º login —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

$password = filter_var(trim($_POST['registerPassword']));
$password = md5($password."myBossIsGay"); // –•–µ—à–∏—Ä—É–µ–º

$fullAvatar = $_POST['avatar'];
$leftLeg = $_POST['leftLeg'];
$rightLeg = $_POST['rightLeg'];
$trousers = filter_var(trim($_POST['registerTrousers']));
$registerPotato = $_POST['registerPotato'];
$registerExperiments = $_POST['registerExperiments'];

$_SESSION['iAmRegister'] = $_POST['registerHealth']; // –î–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ login.php / –°–æ–æ–±—â–∞–µ–º, —á—Ç–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ

$parseAvatar = parse_url($fullAvatar);
$avatar = isset($parseAvatar['path']) ? $parseAvatar['path'] : ''; // –°–æ–∫—Ä–∞—â–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∞–≤–∞—Ç–∞—Ä–∫—É

if ($registerPotato === "on") {
  $registerPotato = "1";
} else {
  $registerPotato = "0";
} // –õ—é–±–∏–º –ª–∏ –º—ã –∫–∞—Ä—Ç–æ—à–∫—É, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –ø–æ–Ω—è—Ç–Ω—ã–π sql —è–∑—ã–∫

if ($registerExperiments === "on") {
  $registerExperiments = "1";
} else {
  $registerExperiments = "0";
} // –ü—Ä–æ–≤–æ–¥–∏–ª–∏ –ª–∏ –Ω–∞–¥ –Ω–∞–º–∏ –æ–ø—ã—Ç—ã, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –ø–æ–Ω—è—Ç–Ω—ã–π sql —è–∑—ã–∫
```

</details>

<details>
<summary>
–ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ SQL
</summary>

```
// –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ SQL
$dataBase = new mysqli('localhost', 'root', '', 'KirGenDB');

// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ SQL, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ login
$query = "SELECT * FROM `users` WHERE login = '$login'";

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∫ SQL –ø–æ –ø–æ–≤–æ–¥—É login
$result = $dataBase->query($query);
```

</details>

<details>
<summary>
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
</summary>

```
if ($result->num_rows > 0) { // –ï—Å–ª–∏ —Ç–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è
  $_SESSION['alreadyExist'] = true;
  header('Location: /register.php');
  $dataBase->close();
} else { // –ï—Å–ª–∏ —Ç–∞–∫–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—â—ë –Ω–µ—Ç, —Å–æ–∑–¥–∞—ë–º
  $dataBase->query("INSERT INTO `users` (`login`, `password`, `avatar`, `leftLeg`, `rightLeg`, `trousers`, `potato`, `experiments`, `health`, `item1`, `item2`, `item3`, `item4`, `item5`, `item6`, `item7`, `item8`, `item9`, `ending1`, `ending2`, `ending3`, `ending4`, `ending5`, `ending6`, `ending7`, `ending8`, `ending9`, `ending10`, `ending11`, `ending12`, `ending13`, `ending14`, `ending15`, `ending16`, `message`, `option1`, `option2`, `option3`, `option4`, `option5`, `option6`, `option7`, `option8`, `option9`, `option10`) VALUES ('$login', '$password', '$avatar', '$leftLeg', '$rightLeg', '$trousers', '$registerPotato', '$registerExperiments', '100', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0')");

  $dataBase->close();

  header('Location: /login.php');
}
```

</details>

## –ó–∞–¥–∞—á–∏
### **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏**
- [x] –∑–∞–¥–∞—á–∞ 1
- [x] –∑–∞–¥–∞—á–∞ 2

***
[ü†î –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ä–∞–∑–¥–µ–ª—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ front-end](https://github.com/KirGenHeart/documentation/blob/main/front-end/front-end-dev.md)